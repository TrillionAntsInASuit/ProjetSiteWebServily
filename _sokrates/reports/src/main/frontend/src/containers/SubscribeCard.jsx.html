<html>
<head>
    <title>frontend/src/containers/SubscribeCard.jsx</title>
    <style type="text/css" media="screen">
        #editor {
            position: absolute;
            top: 40px;
            right: 0;
            bottom: 0;
            left: 0;
        }
    </style>
</head>
<body style="font-family: 'DejaVu Sans', Arial, Helvetica, sans-serif">
<h3 style="margin-bottom: 0">frontend/src/containers/SubscribeCard.jsx (<b>61</b> lines of code) (<a href="SubscribeCard.jsx">raw</a>):</h3>
<div id="editor">import React, { useEffect, useState } from &quot;react&quot;;
import { supabase } from &quot;../../../backend/util/supabaseClient&quot;;
import &quot;./Subscribe.css&quot;;

const SubscribeCard = ({ plan, showTestButton = false }) =&gt; {
  const [user, setUser] = useState(null);

  useEffect(() =&gt; {
    const getUser = async () =&gt; {
      const { data } = await supabase
        .from(&quot;users&quot;)
        .select(&quot;*&quot;)
        .eq(&quot;id&quot;, localStorage.getItem(&quot;userId&quot;))
        .single();
      setUser(data);
    };
    getUser();
  }, []);

  const handleSubscribe = async (priceId) =&gt; {
    try {
      const response = await fetch(&quot;http://localhost:5000/create-checkout-session&quot;, {
        method: &quot;POST&quot;,
        headers: { &quot;Content-Type&quot;: &quot;application/json&quot; },
        body: JSON.stringify({ priceId, userId: localStorage.getItem(&quot;userId&quot;) }),
      });

      if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

      const session = await response.json();
      if (!session.url) {
        alert(&quot;Error: No checkout URL received&quot;);
        return;
      }
      window.location.href = session.url;
    } catch (error) {
      alert(&quot;Error: &quot; + error.message);
    }
  };

  const testBackend = async () =&gt; {
    try {
      const response = await fetch(&quot;https://backend-3hpxq63ak-trillionantsinasuits-projects.vercel.app/create-checkout-session&quot;, {
        method: &quot;POST&quot;,
        headers: { &quot;Content-Type&quot;: &quot;application/json&quot; },
        body: JSON.stringify({ priceId: &quot;test_price_id&quot;, userId: &quot;test_user_id&quot; }),
      });
      const text = await response.text();
      alert(&quot;Response status: &quot; + response.status);
    } catch (error) {
      alert(&quot;Error: &quot; + error.message);
    }
  };

  return (
    &lt;div className=&quot;subscribe&quot;&gt;
      &lt;h1&gt;Subscribe&lt;/h1&gt;
      &lt;div className=&quot;subscribe-box&quot;&gt;
        &lt;h2&gt;{plan.name}&lt;/h2&gt;
        &lt;p className=&quot;price&quot;&gt;{plan.price}&lt;/p&gt;
        &lt;p className=&quot;price-period&quot;&gt;per month&lt;/p&gt;
        &lt;button onClick={() =&gt; handleSubscribe(plan.priceId)}&gt;Subscribe Now&lt;/button&gt;
        {showTestButton &amp;&amp; &lt;button onClick={testBackend}&gt;Test Backend&lt;/button&gt;}
      &lt;/div&gt;
    &lt;/div&gt;
  );
};

export default SubscribeCard;</div>
<script src="https://www.zeljkoobrenovic.com/tools/common/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/html");
    editor.setTheme("ace/theme/xcode");
    editor.setReadOnly(true);
    editor.setOption("wrap", true);
    editor.setPrintMarginColumn(120);
</script>
</body>
